<!DOCTYPE html>
<html>
<head>
  <title>Student Tracker</title>
</head>
<body>
  <h1>Student Performance Tracker</h1>

  <form id="studentForm">
    <input type="text" id="name" placeholder="Name" required />
    <input type="number" step="0.01" id="gpa" placeholder="GPA" required />
    <button type="submit">Add Student</button>
  </form>

  <button onclick="window.location.href='/export-csv'">Export CSV</button>

  <h2>Students List</h2>
  <ul id="studentList"></ul>

  <script>
    function loadStudents() {
      fetch("/students")
        .then(res => res.json())
        .then(data => {
          const list = document.getElementById("studentList");
          list.innerHTML = "";
          data.forEach(s => {
            list.innerHTML += `<li>${s.name} - GPA: ${s.gpa}</li>`;
          });
        });
    }

    document.getElementById("studentForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const name = document.getElementById("name").value;
      const gpa = document.getElementById("gpa").value;

      fetch("/add", {
        method: "POST",
        headers: { "Content-Type": "application/x-www-form-urlencoded" },
        body: `name=${encodeURIComponent(name)}&gpa=${encodeURIComponent(gpa)}`
      }).then(() => {
        loadStudents();
        this.reset();
      });
    });

    loadStudents();
  </script>
</body>
</html>
